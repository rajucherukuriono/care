<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <description>Email To Customer On Bug Resolution</description>
        <name>Email_To_Customer_On_Bug_Resolution</name>
        <label>Email To Customer On Bug Resolution</label>
        <locationX>50</locationX>
        <locationY>431</locationY>
        <actionName>Case.Email_to_Customer_on_Bug_Resolution</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Email_Send_Date</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Case.Email_to_Customer_on_Bug_Resolution</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>58.0</apiVersion>
    <decisions>
        <description>If Contact Email Exist, email will send out to Contact Email on Case</description>
        <name>If_Contact_Email_Exist</name>
        <label>If Contact Email Exist</label>
        <locationX>182</locationX>
        <locationY>323</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Check_if_Contact_Exist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ContactId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ContactEmail</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Bug_Email_Send_Date__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.SF_Jira_Tracker__r.Jira_Status__c</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Email_To_Customer_On_Bug_Resolution</targetReference>
            </connector>
            <label>Check if Contact Exist</label>
        </rules>
    </decisions>
    <description>Email Alert to Contact Email for Bug Resolution on Standard Case for MemberCare Team</description>
    <environments>Default</environments>
    <formulas>
        <description>BugEmailSentDate</description>
        <name>BugEmailDate</name>
        <dataType>Date</dataType>
        <expression>Today()</expression>
    </formulas>
    <interviewLabel>Bug Resolution for Membercare {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Bug Resolution Email to Customer for Membercare</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>creating email message</description>
        <name>creating_email_message</name>
        <label>creating email message</label>
        <locationX>50</locationX>
        <locationY>647</locationY>
        <connector>
            <targetReference>Email_Message</targetReference>
        </connector>
        <inputAssignments>
            <field>FromAddress</field>
            <value>
                <elementReference>$User.Email</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HtmlBody</field>
            <value>
                <elementReference>EmailBody</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>EmailSubject</elementReference>
            </value>
        </inputAssignments>
        <object>EmailMessage</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Email_Message</name>
        <label>Email Message</label>
        <locationX>50</locationX>
        <locationY>755</locationY>
        <inputAssignments>
            <field>EmailMessageId</field>
            <value>
                <elementReference>creating_email_message</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelationAddress</field>
            <value>
                <elementReference>$Record.Contact.Email</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelationType</field>
            <value>
                <stringValue>ToAddress</stringValue>
            </value>
        </inputAssignments>
        <object>EmailMessageRelation</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordUpdates>
        <name>Email_Send_Date</name>
        <label>Email Send Date</label>
        <locationX>50</locationX>
        <locationY>539</locationY>
        <connector>
            <targetReference>creating_email_message</targetReference>
        </connector>
        <inputAssignments>
            <field>Bug_Email_Send_Date__c</field>
            <value>
                <elementReference>BugEmailDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>56</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>If_Contact_Email_Exist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>01270000000Dq7EAAS</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Closed</stringValue>
            </value>
        </filters>
        <filters>
            <field>Bug_Summary__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SF_Jira_Tracker__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>Case</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>EmailBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Dear Customer,&amp;nbsp;&lt;/p&gt;&lt;p&gt;We hope this message finds you well.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Bug Summary , has been successfully fixed. Our team worked diligently to address the issue, and we apologize for any inconvenience it may have caused. If you are using the app, please ensure you are using the latest version.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;We appreciate your patience and understanding throughout this process. If you encounter any other issues or have any questions, please don&apos;t hesitate to reach out to our support team.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Thank you for bringing the bug to our attention and for being a valued customer. We truly appreciate your continued support.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Best regards,&lt;/p&gt;&lt;p&gt;The Member Care Team&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailSubject</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Reported Site Issue Fixed</text>
    </textTemplates>
    <variables>
        <name>textbody</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>Email_To_Customer_On_Bug_Resolution</elementReference>
        </value>
    </variables>
</Flow>
